#!/bin/sh -e

# Install xorg-driver-fglrx, start the script, and put its output to
# modalias_override/fglrx.

echo "# Listing generated by fglrx_supported. Do not edit manually."

[ -e /usr/lib/xorg/modules/drivers/fglrx_drv.so ] || {
    echo "You need to install the package xorg-driver-fglrx for this script" >&2
    exit 1
}

strings /usr/lib/xorg/modules/drivers/fglrx_drv.so | \
  sed -n 's/^0x\([0-9A-F]\{4\}\)$/alias pci:v00001002d0000\1sv*sd*bc03sc*i* fglrx/p' | \
  sort
